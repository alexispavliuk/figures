<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Figures</title>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
	<style>
    	* { 
    		padding: 0; margin:0;
    		text-align: center;
    		font-family:"Montserrat";
    	}
    </style>
</head>
<body>
	<script>
		let canvas;
		let context;
		let parallelogramExists = false;
		let coords = new Array();
		window.onload = function() {
			canvas = document.querySelector("canvas");
			context = canvas.getContext("2d");
			canvas.onclick = draw_circles;
			}
		// allows user to draw circles at canvas
		// while there is no 3 circles drawed by user we allow him to do that
		function draw_circles(e) {
			if (parallelogramExists) {
				return;
			}

			var x = e.pageX - (document.documentElement.clientWidth - canvas.width)/2;
			var y = e.pageY - canvas.offsetTop;
			coords.push([x,y]);

  			context.strokeStyle = '#ff2626';

			context.beginPath();
			context.arc(x, y, 5.5, 0, Math.PI * 2, true);
			context.stroke();
			context.closePath();

			// if user drawed 3 circles - we should draw parallelogram
			if (coords.length == 3) {
				parallelogramExists = true;
				drawParal();
			}
		}
		// draw parallelogram by 3 roots
		function drawParal() {
			x_fourth_root = coords[2][0] - coords[1][0] + coords[0][0];
			y_fourth_root = coords[2][1] - coords[1][1] + coords[0][1];
			coords.push([x_fourth_root, y_fourth_root]);

			context.strokeStyle = '#7775f8';
			context.lineWidth = 3;

			context.beginPath();
			context.moveTo(coords[0][0], coords[0][1]);
			context.lineTo(coords[1][0], coords[1][1]);
			context.lineTo(coords[2][0], coords[2][1]);
			context.lineTo(x_fourth_root, y_fourth_root);
			context.lineTo(coords[0][0], coords[0][1]);
			context.stroke();

			// calculate square of parallelogram
			// We will use Heron's formula and calculate half of parallelogram`s square and then double it
			// first of all lets find lenght of 3 sides
			let a = Math.sqrt( Math.pow(coords[0][0] - coords[1][0], 2) + Math.pow(coords[0][1] - coords[1][1], 2) );
			let b = Math.sqrt( Math.pow(coords[1][0] - coords[2][0], 2) + Math.pow(coords[1][1] - coords[2][1], 2) );
			let c = Math.sqrt( Math.pow(coords[2][0] - coords[0][0], 2) + Math.pow(coords[2][1] - coords[0][1], 2) );
			// now calculate semi-perimeter
			let p = (a+b+c)/2;
			// find square
			let square = 2 * Math.sqrt( p*(p-a)*(p-b)*(p-c) );
			// call func to draw yellow circle
			drawYellowCircle(square);
		}
	    // draw yellow circle in the centre of paralellogram
		function drawYellowCircle(square) {
			// calculate coords of circle
			// it`s enough to find the middle of one of the diagonals
			x_circle = (coords[0][0] + coords[2][0])/2;
			y_circle = (coords[0][1] + coords[2][1])/2;
			// calculate radius 
			let radius = Math.sqrt( square / Math.PI );

			context.strokeStyle = 'yellow';
			context.lineWidth = 3;

			context.beginPath();
			context.arc(x_circle, y_circle, radius, 0, Math.PI * 2, true);
			context.stroke();
			context.closePath();
		}
		function clearCanvas() {
			context.clearRect(0, 0, canvas.width, canvas.height);
			parallelogramExists = false;
			coords = [];
		}
	</script>
	<canvas id="canvas" width="1000" height="500" style="margin: auto; border:1px solid black; margin-top: 5vh"></canvas>
	<div>
	<button id="buttton" onclick="clearCanvas()" style="margin-top: 10px;">
		<font size="5px">clear</font>
	</button>
	</div>
</body>
</html>